## Overview

**Soft authentication tokens** are digital one-time passwords (OTPs) generated by identity providers to authenticate users without requiring physical hardware. Unlike [[hardware tokens]], they exist entirely in software.

## Core Characteristics

- **Digital implementation** - exists in software rather than physical hardware
- **Time-based** or **counter-based** algorithms
- **Limited validity period** - typically 30-60 seconds
- **Designed for single use** - new token generated for each authentication attempt

## Delivery Methods

### SMS/Text Delivery

![[SMS Delivery Method]]

- OTP sent to registered phone number
- **Security classification**: Two-step verification (not true MFA)
- **Vulnerabilities**:
    - SIM swapping attacks
    - SS7 network interception
    - Malware on mobile device
    - Social engineering of mobile carrier representatives
- **Regulatory status**: NIST Special Publication 800-63B deprecated SMS as secure authentication

### Email Delivery

![[Email Delivery Method]]

- OTP sent to registered email address
- **Security classification**: Two-step verification (not true MFA)
- **Vulnerabilities**:
    - Email account compromise
    - Man-in-the-middle attacks
    - Email infrastructure vulnerabilities
    - Unencrypted email transmission
- **Primary weakness**: Reliant on the security of another account

### Authenticator Apps

![[Authenticator App Method]]

- Software installed on computer or smartphone
- **Examples**: Google Authenticator, Microsoft Authenticator, Authy, Duo Mobile
- **Security classification**: Can qualify as true MFA when combined with device authentication
- **Implementation**:
    - Shared secret established during enrollment (typically via QR code)
    - Time-based algorithm (TOTP) or counter-based (HOTP)
    - Requires device authentication to access tokens

## Technical Implementation

### TOTP (Time-based One-Time Password)

- Based on RFC 6238
- Formula: `TOTP = HMAC(SecretKey, CurrentTime)`
- Requires synchronized time between authenticator and server
- Default time step: 30 seconds
- Typically uses SHA-1, SHA-256, or SHA-512 hashing

### HOTP (HMAC-based One-Time Password)

- Based on RFC 4226
- Formula: `HOTP = HMAC(SecretKey, Counter)`
- Counter incremented with each use
- Requires counter synchronization between authenticator and server
- Vulnerable to desynchronization issues

## Security Considerations

### Strengths

- No physical token to lose or damage
- Easy distribution and management
- Can be deployed at scale with minimal cost
- User familiarity and acceptance

### Weaknesses

- [[Supply Chain Security|Supply chain vulnerabilities]] in authenticator apps
- Device compromise risks
- Dependency on device security
- Backup/recovery procedures can create security vulnerabilities
- Shared device risks

### Risk Mitigation

- Add device binding
- Implement secure enrollment procedures
- Employ risk-based authentication alongside token validation
- Monitor for unusual authentication patterns
- Implement rate limiting and lockout policies

## Regulatory and Compliance Implications

### PCI DSS Implications

- Acceptable for multi-factor authentication under PCI DSS 4.0
- Transaction-specific authentication requirements for high-risk transactions

### GDPR Considerations

- Must protect the security of processing (Article 32)
- Data breach notification requirements if token database is compromised

### SOC 2 Framework

- Meets logical access controls requirements when properly implemented
- Should be included in security control documentation

## Implementation Best Practices

### Enrollment Security

- Out-of-band verification during enrollment
- Strong identity proofing before issuing soft tokens
- Secure transmission of shared secrets/seed values

### Algorithm Selection

- TOTP preferred over HOTP for most implementations
- Consider longer token validity for poor connectivity scenarios
- Implement appropriate token entropy (minimum 6 digits)

### User Experience Considerations

- Balance security with usability
- Consider accessibility needs
- Provide recovery options that don't undermine security
- Clear user education on security importance

## Comparison to Other Authentication Methods

|Method|Security Level|User Convenience|Implementation Cost|Scalability|
|---|---|---|---|---|
|SMS OTP|Low|High|Low|High|
|Email OTP|Low|High|Low|High|
|Authenticator App|Medium-High|Medium|Low|High|
|Hardware Token|High|Low|High|Medium|
|Biometrics|Medium-High|High|Medium-High|Medium|
|Push Notification|Medium|High|Medium|High|

## Real-World Applications

### Banking and Finance

- Used for transaction authorization
- Often combined with risk-based authentication
- Regulatory requirements often mandate use

### Enterprise Access Management

- Common for VPN access
- Cloud service authentication
- Administrative access to critical systems

### Consumer Applications

- Social media account protection
- Email security
- E-commerce payment verification

## Future Trends and Developments

### FIDO2 and WebAuthn

- Moving beyond traditional OTP to cryptographic authentication
- Public key cryptography rather than shared secrets
- Better protection against phishing attacks

### Passwordless Authentication

- Soft tokens as primary rather than secondary authentication
- Biometric unlock of soft token applications
- Continuous authentication models

### AI and Behavioral Analysis

- Combining soft tokens with behavioral risk assessment
- Adaptive authentication based on context

## References

- NIST Special Publication 800-63B: Digital Identity Guidelines
- RFC 6238: Time-Based One-Time Password Algorithm
- RFC 4226: HMAC-Based One-Time Password Algorithm
- OWASP Authentication Cheat Sheet
